---
tags:
  - SQL
---

| **Функция**         | **Описание**                                                                                                                                                                                                                                   | **Пример использования**                                                                                                    |
| ------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------- |
| **`UPPER()`**       | Преобразует строку в верхний регистр.                                                                                                                                                                                                          | `SELECT UPPER(first_name) FROM employees;`                                                                                  |
| **`LOWER()`**       | Преобразует строку в нижний регистр.                                                                                                                                                                                                           | `SELECT LOWER(last_name) FROM employees;`                                                                                   |
| **`LENGTH()`**      | Возвращает длину строки.                                                                                                                                                                                                                       | `SELECT LENGTH(first_name) FROM employees;`                                                                                 |
| **`SUBSTRING()`**   | Используется для извлечения подстроки из строки, начиная с заданной позиции и продолжая на указанное количество символов. Эта функция полезна в случаях, когда необходимо получить часть строки для анализа, форматирования или вывода данных. | `SELECT SUBSTR('Hello, World!', 1, 5) AS substring_example;Результат:_ Hello`<br>`                                          |
| **`TRIM()`**        | Используется для удаления пробелов и других символов из начала и конца строки. Эта функция полезна для очистки данных, особенно если они были введены пользователем с лишними пробелами или форматированием.                                   | `SELECT TRIM(BOTH 'x' FROM 'xxxHello, World!xxx') AS trimmed_string;<br>`                                                   |
| **`CONCAT()`**      | Объединяет две или несколько строк.                                                                                                                                                                                                            | `SELECT CONCAT(first_name, ' ', last_name) FROM employees;`                                                                 |
| **`CHARINDEX()`**   | Возвращает позицию подстроки в строке.                                                                                                                                                                                                         | `SELECT CHARINDEX('John', first_name) FROM employees;`                                                                      |
| **`REPLACE()`**     | Заменяет подстроку на другую подстроку.                                                                                                                                                                                                        | `SELECT REPLACE(last_name, 'Smith', 'Johnson') FROM employees;`                                                             |
| **`ROUND()`**       | Округляет число до указанного количества знаков после запятой.                                                                                                                                                                                 | `SELECT ROUND(salary, 2) FROM employees;`                                                                                   |
| **`ABS()`**         | Возвращает абсолютное значение числа.                                                                                                                                                                                                          | `SELECT ABS(salary) FROM employees;`                                                                                        |
| **`NOW()`**         | Возвращает текущую дату и время на сервере.                                                                                                                                                                                                    | `SELECT NOW();`                                                                                                             |
| **`CAST()`**        | Преобразует значение в указанный тип данных.                                                                                                                                                                                                   | `SELECT CAST(salary AS VARCHAR(10)) FROM employees;`                                                                        |
| `INITCAP()`         | Делает первую букву каждого слова заглавной, а остальные буквы — строчными.                                                                                                                                                                    | `SELECT INITCAP(first_name \|\| ' ' \|\| last_name) AS formatted_name FROM employees;`<br>                                  |
| `LPAD()` и `RPAD()` | Используются для дополнения строк до заданной длины с помощью определённого символа. *Эти функции полезны для форматирования данных, особенно при работе с выводом, который требует строгого выравнивания.*                                    | `SELECT LPAD('123', 5, '0') AS padded_string;<br><br>_Результат:_ `00123`                                                   |
| `INSTR()`           | Возвращает позицию первого вхождения подстроки в исходной строке или ноль, если подстрока не найдена. `INSTR` полезна при обработке и анализе строковых данных.                                                                                | `SELECT INSTR('Hello, World!', 'World') AS position`;<br>_Результат:_ 8 (первое вхождение 'World' начинается с 8-й позиции) |
| `TRUNC`             | Используется для усечения чисел до определенного количества знаков после запятой. Это полезно, когда вам нужно округлить число без его округления.                                                                                             | SELECT TRUNC(123.4567, 2) AS truncated_value;  -- Результат: 123.45<br><br>                                                 |
| `MOD`               | используется для вычисления остатка от деления одного числа на другое. Это полезно в многих сценариях, таких как определение четности, создание циклических последовательностей и обработка данных.                                            | SELECT MOD(10, 3) AS remainder;  -- Результат: 1<br>                                                                        |
|                     |                                                                                                                                                                                                                                                |                                                                                                                             |
![[Pasted image 20250313123201.png]] ![[Pasted image 20250313230417.png]]
![[Pasted image 20250314002929.png]]

## Заключение

Эта таблица предоставляет обзор функций единственной строки в SQL, которые полезны для выполнения различных операций на уровне одной записи. Понимание и использование этих функций могут улучшить манипуляцию строками и числами в ваших SQL-запросах.



# Расширенные таблицы SQL Функций

Давайте рассмотрим более обширные таблицы с функциями SQL для работы со строками, числами и датами:

## 1. Функции для работы со строками

| Функция         | Описание                                                  | Пример использования                              |
|------------------|----------------------------------------------------------|--------------------------------------------------|
| `UPPER()`        | Преобразует строку в верхний регистр                     | `SELECT UPPER('hello') AS result;`              |
| `LOWER()`        | Преобразует строку в нижний регистр                     | `SELECT LOWER('HELLO') AS result;`              |
| `CONCAT()`       | Объединяет две или более строк                           | `SELECT CONCAT('Hello', ' ', 'World') AS result;` |
| `SUBSTRING()`    | Извлекает подстроку из строки                            | `SELECT SUBSTRING('Hello World', 1, 5) AS result;` |
| `TRIM()`         | Удаляет пробелы в начале и конце строки                 | `SELECT TRIM('   Hello   ') AS result;`         |
| `LENGTH()`       | Возвращает длину строки                                  | `SELECT LENGTH('Hello') AS result;`             |
| `CHARINDEX()`    | Возвращает позицию первого вхождения подстроки         | `SELECT CHARINDEX('lo', 'Hello') AS position;`  |
| `REPLACE()`      | Заменяет все вхождения подстроки на другую подстроку   | `SELECT REPLACE('Hello World', 'World', 'SQL') AS result;` |
| `LEFT()`         | Извлекает указанное число символов слева                 | `SELECT LEFT('Hello', 3) AS result;`            |
| `RIGHT()`        | Извлекает указанное число символов справа                | `SELECT RIGHT('Hello', 3) AS result;`           |
| `SOUNDEX()`      | Возвращает Soundex-код строки для сравнения с другими строками | `SELECT SOUNDEX('Smith') AS soundex_code;`     |
| `FORMAT()`       | Форматирует строку с указанным параметром                | `SELECT FORMAT(12345, 'N0') AS formatted;`      |

## 2. Функции для работы с числами

| Функция         | Описание                                                       | Пример использования                               |
|------------------|---------------------------------------------------------------|---------------------------------------------------|
| `ABS()`          | Возвращает абсолютное значение числа                          | `SELECT ABS(-10) AS result;`                     |
| `ROUND()`        | Округляет число до указанного количества знаков              | `SELECT ROUND(123.4567, 2) AS result;`          |
| `FLOOR()`        | Возвращает наибольшее целое число, меньшее или равное данному | `SELECT FLOOR(123.456) AS result;`               |
| `CEIL()`         | Возвращает наименьшее целое число, большее или равное данному  | `SELECT CEIL(123.456) AS result;`                |
| `MOD()`          | Вычисляет остаток от деления                                   | `SELECT MOD(10, 3) AS result;`                   |
| `SQRT()`         | Возвращает квадратный корень числа                            | `SELECT SQRT(16) AS result;`                      |
| `POWER()`        | Возводит число в указанную степень                            | `SELECT POWER(2, 3) AS result;`                  |
| `EXP()`          | Возвращает значение числа Эйлера, возведенное в указанную степень | `SELECT EXP(1) AS result;`                     |
| `LOG()`          | Возвращает натуральный логарифм числа                        | `SELECT LOG(10) AS result;`                       |
| `RAND()`         | Возвращает случайное число от 0 до 1                          | `SELECT RAND() AS random_number;`                |

## 3. Функции для работы с датами

| Функция          | Описание                                                | Пример использования                              |
|------------------|--------------------------------------------------------|--------------------------------------------------|
| `CURRENT_DATE`   | Возвращает текущую дату                               | `SELECT CURRENT_DATE AS today;`                 |
| `NOW()`          | Возвращает текущую дату и время                       | `SELECT NOW() AS current_datetime;`             |
| `DATEADD()`      | Добавляет интервал к дате                              | `SELECT DATEADD(DAY, 5, '2025-03-13') AS future_date;` |
| `DATEDIFF()`     | Вычисляет разницу между двумя датами                  | `SELECT DATEDIFF(DAY, '2025-03-13', '2025-03-18') AS days_difference;` |
| `FORMAT()`       | Форматирует дату в заданный формат                   | `SELECT FORMAT(GETDATE(), 'yyyy-MM-dd') AS formatted_date;` |
| `YEAR()`         | Извлекает год из даты                                 | `SELECT YEAR('2025-03-13') AS year_value;`     |
| `MONTH()`        | Извлекает месяц из даты                               | `SELECT MONTH('2025-03-13') AS month_value;`   |
| `DAY()`          | Извлекает день из даты                                | `SELECT DAY('2025-03-13') AS day_value;`       |
| `GETDATE()`      | Возвращает текущее системное время                   | `SELECT GETDATE() AS current_time;`             |
| `EOMONTH()`      | Возвращает последний день месяца заданной даты       | `SELECT EOMONTH('2025-03-13') AS last_day;`     |

Эти более полные таблицы демонстрируют разнообразие функций, доступных в SQL для работы со строками, числами и датами. Надеюсь, это поможет вам лучше ориентироваться в SQL, усиливая ваши навыки работы с данными!
Эти таблицы предоставляют обзор основных функций SQL для работы с разными типами данных и могут значительно упростить выполнение различных операций с данными в SQL.