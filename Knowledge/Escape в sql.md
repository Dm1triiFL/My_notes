---
tags:
  - SQL
---
# Ключевое слово `ESCAPE` в SQL

## Описание

Ключевое слово `ESCAPE` используется в SQL для определения пользовательского символа экранирования в выражениях `LIKE`. Это позволяет указать специальный символ, который будет использоваться для экранирования символов специального значения, таких как символы подчеркивания (`_`) и процента (`%`), когда они используются в строке поиска.

## Использование

### 1. **Контекст применения**

`ESCAPE` часто используется в запросах `SELECT`, когда необходимо искать строки с символами, которые по умолчанию имеют специальные значения в контексте `LIKE`. 

### 2. **Синтаксис**

```sql
LIKE pattern ESCAPE 'escape_character'
```

- **`pattern`**: Строка, которая используется для поиска. Содержит символы подчеркивания и процента.
- **`escape_character`**: Указывает символ, который будет использоваться для экранирования.

## Примеры использования

### Пример 1: Поиск с использованием `ESCAPE`

Предположим, у вас есть таблица `products`, и в ней есть название продукта, включая символы `%` и `_`.

```sql
CREATE TABLE products (
    id INT,
    product_name VARCHAR(50)
);

INSERT INTO products (id, product_name) VALUES (1, 'Product_1');
INSERT INTO products (id, product_name) VALUES (2, 'Product%2');
INSERT INTO products (id, product_name) VALUES (3, 'Special&Product');
```

Если вы хотите найти все продукты, которые содержат символ `_`, вы можете использовать `ESCAPE`, чтобы указать, какой символ будет использоваться для экранирования.

```sql
SELECT * 
FROM products 
WHERE product_name LIKE 'Product\_%' ESCAPE '\';
```

В этом запросе `\` является символом экранирования, и мы ищем продукты, которые начинаются с `Product` и за которыми следует символ подчеркивания.

### Пример 2: Поиск с символом `%`

Если вы хотите найти продукты с `%` в названии, вы можете сделать так:

```sql
SELECT * 
FROM products 
WHERE product_name LIKE 'Product\%%' ESCAPE '\';
```

Здесь мы ищем все продукты, которые начинаются с `Product` и заканчиваются символом `%`, используя символ `\` для экранирования.

## Примечания

- Если не указать `ESCAPE`, символы `_` и `%` будут рассматриваться как подстановочные символы, что может привести к неожиданным результатам при поиске.
- Используйте `ESCAPE`, чтобы обеспечить корректность поиска и избежать путаницы из-за символов, имеющих специальные значения.

## Заключение

Ключевое слово `ESCAPE` в SQL является мощным инструментом для управления поиском строк с использованием `LIKE`. Оно позволяет точно указать, какие символы следует воспринимать как обычные, избегая недоразумений, вызванных специальными символами. Правильное использование `ESCAPE` помогает создавать более точные и безопасные SQL-запросы.